<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kelantan Islamic System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            background: url('https://source.unsplash.com/1600x900/?ramadan,mosque') no-repeat center center fixed;
            background-size: cover;
        }
        .quran-text {
            font-family: 'Amiri', serif;
            font-size: 1.5rem;
            direction: rtl;
            text-align: center;
            margin-top: 10px;
        }
        .quran-translation {
            font-family: 'Roboto', sans-serif;
            font-size: 1rem;
            text-align: center;
        }
        .logo {
            width: 100px;
            margin: 0 auto;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-900">
    <div class="container mx-auto p-6 text-center">
        <img src="logo.png" alt="Logo" class="logo mb-4">
        <h1 class="text-3xl font-bold mb-4">Waktu Solat - Malaysia</h1>

<label for="zoneSelect" class="block text-lg font-semibold">Pilih Zon:</label>
<select id="zoneSelect" class="mt-2 p-2 border border-gray-300 rounded text-black" onchange="getPrayerTimes()">
    <option value="">Pilih Zon</option>

    <!-- Selangor -->
    <optgroup label="Selangor">
        <option value="SGR01">Gombak, Petaling, Sepang, Hulu Langat, Hulu Selangor, Shah Alam</option>
        <option value="SGR02">Kuala Selangor, Sabak Bernam</option>
        <option value="SGR03">Klang, Kuala Langat</option>
    </optgroup>

    <!-- Kuala Lumpur -->
    <optgroup label="Kuala Lumpur">
        <option value="KUL01">Kuala Lumpur</option>
    </optgroup>

    <!-- Wilayah Persekutuan -->
    <optgroup label="Wilayah Persekutuan">
        <option value="WLY01">Putrajaya</option>
        <option value="WLY02">Labuan</option>
    </optgroup>

    <!-- Johor -->
    <optgroup label="Johor">
        <option value="JHR01">Johor Bahru, Kota Tinggi</option>
        <option value="JHR02">Mersing, Segamat</option>
    </optgroup>

    <!-- Kedah -->
    <optgroup label="Kedah">
        <option value="KDH01">Alor Setar, Kubang Pasu, Pokok Sena, Pendang, Kuala Muda, Yan, Padang Terap</option>
        <option value="KDH02">Kulim, Bandar Baharu</option>
    </optgroup>

    <!-- Kelantan -->
    <optgroup label="Kelantan">
        <option value="KTN01">Kota Bharu, Bachok, Pasir Puteh, Tumpat</option>
        <option value="KTN02">Jeli, Gua Musang</option>
    </optgroup>

    <!-- Pahang -->
    <optgroup label="Pahang">
        <option value="PHG01">Kuantan, Pekan, Rompin</option>
        <option value="PHG02">Temerloh, Bera</option>
    </optgroup>

    <!-- Melaka -->
    <optgroup label="Melaka">
        <option value="MLK01">Bandar Melaka, Alor Gajah, Jasin</option>
    </optgroup>

    <!-- Negeri Sembilan -->
    <optgroup label="Negeri Sembilan">
        <option value="NSN01">Seremban, Port Dickson, Jelebu, Rembau</option>
        <option value="NSN02">Tampin, Jempol</option>
    </optgroup>

    <!-- Perlis -->
    <optgroup label="Perlis">
        <option value="PHR01">Kangar, Padang Besar, Arau</option>
    </optgroup>

    <!-- Pulau Pinang -->
    <optgroup label="Pulau Pinang">
        <option value="PNG01">Pulau Pinang</option>
    </optgroup>

    <!-- Sarawak -->
    <optgroup label="Sarawak">
        <option value="SWK01">Limbang, Lawas, Sundar, Trusan</option>
        <option value="SWK02">Miri, Niah, Bekenu, Sibuti, Marudi</option>
        <option value="SWK03">Pandan, Belaga, Suai, Tatau, Sebauh, Bintulu</option>
        <option value="SWK04">Sibu, Mukah, Dalat, Song, Igan, Oya, Balingian, Kanowit, Kapit</option>
        <option value="SWK05">Sarikei, Matu, Julau, Rajang, Daro, Bintangor, Belawai</option>
        <option value="SWK06">Lubok Antu, Sri Aman, Roban, Debak, Kabong, Lingga, Engkelili, Betong, Spaoh, Pusa, Saratok</option>
        <option value="SWK07">Serian, Simunjan, Samarahan, Sebuyau, Meludam</option>
        <option value="SWK08">Kuching, Bau, Lundu, Sematan</option>
        <option value="SWK09">Zon Khas (Kampung Patarikan)</option>
    </optgroup>

    <!-- Sabah -->
    <optgroup label="Sabah">
        <option value="SBH01">Bahagian Sandakan (Timur), Bukit Garam, Semawang, Temanggong, Tambisan, Bandar Sandakan, Sukau</option>
        <option value="SBH02">Beluran, Telupid, Pinangah, Terusan, Kuamut, Bahagian Sandakan (Barat)</option>
        <option value="SBH03">Lahad Datu, Silabukan, Kunak, Sahabat, Semporna, Tungku, Bahagian Tawau (Timur)</option>
        <option value="SBH04">Bandar Tawau, Balong, Merotai, Kalabakan, Bahagian Tawau (Barat)</option>
        <option value="SBH05">Kudat, Kota Marudu, Pitas, Pulau Banggi, Bahagian Kudat</option>
        <option value="SBH06">Gunung Kinabalu</option>
        <option value="SBH07">Kota Kinabalu, Ranau, Kota Belud, Tuaran, Penampang, Papar, Putatan, Bahagian Pantai Barat</option>
        <option value="SBH08">Pensiangan, Keningau, Tambunan, Nabawan, Bahagian Pendalaman (Atas)</option>
        <option value="SBH09">Beaufort, Kuala Penyu, Sipitang, Tenom, Long Pasia, Membakut, Weston, Bahagian Pendalaman (Bawah)</option>
    </optgroup>

</select>


        <p id="hijriDate" class="text-lg mt-4"></p>
        <p id="gregorianDate" class="text-lg mb-4"></p>
        
        <div id="prayerTimes" class="grid grid-cols-2 md:grid-cols-3 gap-4 mb-4"></div>
        
        <div class="bg-blue-600 text-white p-4 rounded-lg shadow-lg mt-6">
            <h2 class="text-lg font-semibold mb-2">Ayat Al-Quran</h2><br>
            <p id="quranVerse" class="quran-text"></p>
            <p id="quranReference" class="quran-translation mt-2"></p>
        </div>
    </div>

    <script>
        async function getPrayerTimes() {
            const zone = document.getElementById("zoneSelect").value;
            if (!zone) return;
            try {
                const response = await fetch(`https://corsproxy.io/?https://www.e-solat.gov.my/index.php?r=esolatApi/TakwimSolat&period=week&zone=${zone}`);
                if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
                const data = await response.json();

                if (!data || !data.prayerTime || !Array.isArray(data.prayerTime)) {
                    throw new Error("Invalid data format received from API");
                }

                const times = data.prayerTime[0]; 
                let output = '';

                const prayerNames = {
                    "imsak": "Imsak",
                    "fajr": "Subuh",
                    "syuruk": "Syuruk",
                    "dhuha": "Dhuha",
                    "dhuhr": new Date().getDay() === 5 ? "Jumaat" : "Zohor",
                    "asr": "Asar",
                    "maghrib": "Maghrib",
                    "isha": "Isyak"
                };

                Object.entries(prayerNames).forEach(([key, name]) => {
                    if (times[key]) {
                        let time12Hour = convertTo12Hour(times[key]);
                        output += `<div class="bg-white p-4 rounded-lg shadow-md">
                            <h3 class="font-semibold">${name}</h3>
                            <p>${time12Hour}</p>
                        </div>`;
                    }
                });
                document.getElementById("prayerTimes").innerHTML = output;
            } catch (error) {
                console.error("Error fetching prayer times:", error);
                alert("Gagal mendapatkan waktu solat. Sila cuba lagi nanti.");
            }
        }

        async function getQuranVerse() {
            try {
                const response = await fetch('https://api.alquran.cloud/v1/ayah/random');
                if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);
                const data = await response.json();

                if (!data || !data.data || !data.data.text || !data.data.surah) {
                    throw new Error("Invalid data format received from API");
                }

                const verseText = data.data.text;
                const surahName = data.data.surah.englishName;
                const verseNumber = data.data.numberInSurah;
                const fullReference = `Surah ${surahName}, Ayat ${verseNumber}`;

                document.getElementById("quranVerse").innerText = verseText;
                document.getElementById("quranReference").innerText = fullReference;
            } catch (error) {
                console.error("Error fetching Quran verse:", error);
                document.getElementById("quranVerse").innerText = "Gagal mendapatkan ayat Al-Quran.";
                document.getElementById("quranReference").innerText = "";
            }
        }

        function displayDate() {
            const today = new Date();
            document.getElementById("gregorianDate").innerText = `ðŸ“… Tarikh Masihi: ${today.toDateString()}`;
            document.getElementById("hijriDate").innerText = `ðŸ  Tarikh Hijri: ${Intl.DateTimeFormat('ar-SA-u-ca-islamic', {dateStyle: 'long'}).format(today)}`;
        }

        function convertTo12Hour(time) {
            let [hours, minutes] = time.split(':').map(Number);
            let period = hours >= 12 ? 'PM' : 'AM';
            hours = hours % 12 || 12;
            return `${hours}:${minutes.toString().padStart(2, '0')} ${period}`;
        }

        getQuranVerse();
        displayDate();
    </script>
</body>
</html>
